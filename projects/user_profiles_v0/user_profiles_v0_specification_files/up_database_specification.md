---
Project: User Profiles
Type: Specifications
Date: 2025-07-17
Spec-ID: SPEC-UP-DB
---

# User Profiles V0 Database Specifications

## Overview
This document details the technical specifications for the database of the User Profiles V0, corresponding to **SPEC-UP-DB** from **4.5.2 User_Profiles_Specifications_Overview.md**. The database stores user profiles, progress data, and RAG embeddings, supporting requirements FR02 (learning progress tracking) and FR03 (portfolio integration). It is designed for solo development within a 20-hour/week schedule, hosted in LXC container `dockProd2` on Proxmox (16 GB RAM, NVMe storage) and mirrored on Linode, using PostgreSQL.

## Technical Specifications
- **Technology**: PostgreSQL.
- **Hosting**: LXC container `dockProd2` on Proxmox, mirrored on Linode for production.
- **Schema**:
  ```sql
  CREATE TABLE users (
      user_id VARCHAR(36) PRIMARY KEY,
      email VARCHAR(255) UNIQUE,
      username VARCHAR(50),
      hashed_password VARCHAR(255),
      created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
  );
  CREATE TABLE progress_data (
      progress_id SERIAL PRIMARY KEY,
      user_id VARCHAR(36),
      task_id VARCHAR(36),
      task_details JSONB,
      completed_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
      FOREIGN KEY (user_id) REFERENCES users(user_id)
  );
  CREATE TABLE portfolio_items (
      item_id SERIAL PRIMARY KEY,
      user_id VARCHAR(36),
      project_details TEXT,
      created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
      FOREIGN KEY (user_id) REFERENCES users(user_id)
  );
  CREATE TABLE rag_embeddings (
      document_id SERIAL PRIMARY KEY,
      document_path VARCHAR(255),
      embedding VECTOR(1536),
      created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
  );
  ```
- **Features**:
  - Stores user profiles with email, username, and hashed passwords (FR01).
  - Tracks learning progress (e.g., completed tasks from Learning Assistant) with JSONB details, supporting 100+ tasks per user (FR02).
  - Stores portfolio project details as markdown-compatible text, supporting 10+ projects per user (FR03).
  - Stores RAG embeddings for progress data and markdown documents, used by Ollama for personalization (FR02).
- **Security**: Encrypted connections via SSL, restricted access to FastAPI and Ollama, secure password hashing with FastAPI Users.

## Implementation Details
- **Development**: Design schema in VS Code, apply via `psql` on Proxmox.
- **Testing**: Validate profile storage, progress tracking, and RAG queries in `dockTest1` (Proxmox).
- **Deployment**: Deploy PostgreSQL in `dockProd2`, mirror to Linode via replication.
- **Dependencies**: Requires backend (SPEC-UP-BACK) for data input, AI-driven website for integration.
- **RAG Pipeline**: Embeddings generated by Ollama, stored in `rag_embeddings`, queried for personalization.
- **RAG Integration**: Store in `/docs/projects/user_profiles_specifications/`, sync to Linode, embed in PostgreSQL for RAG queries.